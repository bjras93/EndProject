@model LifeStruct.Models.FitnessModel
@{
    ViewBag.Title = "Edit workout schedule";
}
@section Signout{
    @Html.Partial("~/Views/Shared/_logout.cshtml")
}
<div class="content">
    <div class="fitness fitness-edit">
        @using (Html.BeginForm("Edit", "Fitness", FormMethod.Post))
        {
            <div ng-app="LifeStruct" ng-controller="FitnessCtrl" class="schedule">
                @Html.HiddenFor(x => x.Id)
                @if (ViewBag.Schedule != null)
                {
                    <div ng-init="getSchedule('@Model.Id')"></div>
                }
               
                <div class="exercise-add" ng-repeat="exercise in exercises">
                    <input ng-model="eList.exercise['s_id_e' + eIndex]" name="{{'s_id_e' + eIndex}}" ng-value="exercise.id" type="hidden">
                    <div ng-init="eIndex = ($index+1)"></div>
                    <h3>Exercise {{eIndex}}</h3>
                    <ul>
                        <li>
                            <select class="ipt" name="s_day_e{{eIndex}}" type="text">
                                @foreach (var day in ViewBag.Days)
                                {
                                    <option ng-selected="exercise.day == @(day.Id)" value="@day.Id">@day.Name</option>
                                }
                            </select>
                        </li>
                        <li>
                            <input autocomplete="off" ng-click="" ng-keyup="showAc($event); sExercise('s_exercise_e' + eIndex, 'notFound_' + eIndex);" onkeydown="keyDown(event);" ng-model="eList.exercise['s_exercise_e' + eIndex]" ng-value="exercise.exercise" class="ipt" name="s_exercise_e{{eIndex}}" placeholder="Exercise" type="text" />
                            <div class="autocomplete-container">
                                <div class="autocomplete" ng-if="eList.exercise['s_exercise_e' + eIndex].length > 0">
                                    <div class="results" ng-repeat="result in exerciseCollection = (allExercises | filter: eList.exercise['s_exercise_e' + eIndex]) | limitTo: 5 ">
                                        <div ng-if="exerciseCollection.length > 0">
                                            <div ng-init="rIndex = ($index+1)"></div>
                                            <a ng-click="setCalories($event, eIndex, rIndex); eList.exercise['s_exercise_e' + eIndex] = result.Name;" onkeydown="keyDown(event);" data-val="{{result.Calories}}" data-id="{{result.Id}}" href="">{{result.Name}}</a>
                                        </div>
                                    </div>
                                    <a data-url="@(Url.Action("_AddNewExercise"))" data-content="{{eList.exercise['s_exercise_e' + eIndex]}}" onkeydown="keyDown(event);" ng-click="$event.preventDefault();" class="open-modal hide" id="{{'notFound_' + eIndex}}" href="">
                                        Could not find {{eList.exercise['s_exercise_e' + eIndex]}} would you like to add it?
                                    </a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <input id="s_calories_e{{eIndex}}" ng-model="eList.exercise['s_calories_e' + eIndex]" ng-value="exercise.calories"  type="hidden" />
                            <input id="s_exerciseId_e{{eIndex}}" ng-model="eList.exercise['s_exerciseId_e' + eIndex]" name="s_exerciseId_e{{eIndex}}" ng-value="exercise.exerciseId" value="{{eList.exercise['s_exerciseId_e' + eIndex]}}" type="hidden" />
                            <input class="ipt" ng-model="eList.exercise['s_interval_e' + eIndex]" name="s_interval_e{{eIndex}}" ng-value="exercise.interval" placeholder="Interval" type="text" />
                            <div ng-if="eList.exercise['s_interval_e' + eIndex].length > 0 && exercise.calories == ''">
                                
                                {{(eList.exercise['s_calories_e' + eIndex] / 60) * eList.exercise['s_interval_e' + eIndex]}} kcal loss
                            </div>
                            <div ng-if="eList.exercise['s_interval_e' + eIndex].length > 0 && exercise.calories != ''">

                                {{(exercise.calories/ 60) * eList.exercise['s_interval_e' + eIndex]}} kcal loss
                            </div>
                        </li>
                    </ul>
                </div>
                <a class="add-day" ng-click="addExercise($event);" href="">Add another day</a>
                <input value="Update schedule" type="submit" class="btn fit-gre" />

            </div>
        }

        <div class="modal-overlay">
            <div id="modal">

            </div>
        </div>
    </div>
</div>
<script src="~/Content/JS/layout/autocomplete.js"></script>
<script src="~/Content/JS/layout/fitness.js"></script>
<script>fitness.schedule(); autocomplete.init(); </script>